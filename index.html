<!DOCTYPE html>
<html id='htmlLang' lang="ja">
<!-- <html lang="ja"> -->

</html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/search.js" defer></script> <!-- 検索機能 -->
    <script src="js/history.js" defer></script> <!-- 履歴機能 -->
    <script src="js/create.js" defer></script> <!-- HTML動的生成機能 -->
    <script src="js/language.js" defer></script> <!-- 多言語対応機能 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">
    <title>ToPickPot</title>
</head>

<header>
    <!-- タイトルと説明 -->
    <h1 id='aboutTitle' class='title'>ToPickPot</h1>
    <p id='aboutTopicPot'></p>

    <div class='menuBox'>
        <!-- 言語セレクトフォーム -->
        <p id='aboutLangType'>language</p>
        <select id="langType" type='text'></select>

        <!-- パネル数セレクトフォーム -->
        <p id='aboutPanelNumber'>Number</p>
        <select id="panelNum" type='number'></select>

        <!-- 更新ボタン -->
        <button id='reLoad'>Go</button>
    </div>
</header>

<body>
    <!-- 検索パネル表示領域 -->
    <div id='searchPanelBox' class='searchResultBox'></div>

    <!-- 検索パネル表示の下には履歴とお気に入りと作者情報並べる -->
    <div class='actionResultBox'>

        <!-- 検索履歴表示領域 -->
        <div class='hisBox'>
            <h2 id='aboutResent'></h2>
            <div id='resentList'></div>
            <button id='deleteHistory'>delete history</button>
        </div>

        <!-- お気に入り表示領域 -->
        <div class='favBox'>
            <h2 id='aboutFavorite'>お気に入り</h2>
            <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            <div id='favoriteList'></div>
            <button id='deleteFavorite'>delete favorite</button>
        </div>

        <!-- about me表示領域 -->
        <div class='autherBox'>
            <h2 id='aboutAuther'>Auther</h2>
            <div id='autherList'>
            </div>
        </div>
    </div>

</body>

<hr>

<footer>
    <!-- 初期化ボタン -->
    <button id='init'>初期化</button>
</footer>


<script>
    $(document).ready(function () {
        //定数定義
        const PANELMAX = 100;

        //ローカルデータ
        let localData;
        let jsonData;

        //初期設定
        if (localStorage.getItem('localDataJson') === null) {
            //ローカルストレージの初期設定(デフォルトは日本語の3x3)
            localData = {
                lang: '4',      //ページの言語
                panelNum: '9',    //パネルの数
                his: {
                    cnt: '0',    //履歴のカウンタ
                    max: '100',  //履歴の最大保持数
                    ary: [],
                },
                fav: {
                    cnt: '0',    //履歴のカウンタ
                    max: '100',  //履歴の最大保持数
                    ary: [],
                },
            }
            jsonData = JSON.stringify(localData)
            localStorage.setItem('localDataJson', jsonData);
        }
        else {
            //ローカルストレージから読み出し
            jsonData = localStorage.getItem('localDataJson');
            localData = JSON.parse(jsonData);
        }

        //言語設定
        languageChange(localData.lang);

        //言語セレクトフォーム作成
        createLangForm();
        $('#langType').val(localData.lang);

        //パネル数セレクトフォーム作成
        createPanelNumForm(PANELMAX);
        $('#panelNum').val(localData.panelNum);

        //言語設定と検索パネル作成
        createSearchPanel(localData.lang, localData.panelNum);

        //履歴作成
        if (localData.his.cnt != 0) {
            createHis();
        }

        //お気に入り作成
        if (localData.fav.cnt != 0) {
            createFav();
        }

        createAuther();

    });

</script>

</html>